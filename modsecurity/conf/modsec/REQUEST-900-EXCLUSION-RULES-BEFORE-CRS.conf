# Deactivate Rule 920180 to permit empty Body on POST without header Content-Length
# It's a best pratice but not required as said in RFC 9110
# This refer to issue #68

SecRule REQUEST_URI "@beginsWith /api/" \
    "id:10001,\
     phase:1,\
     pass,\
     nolog,\
     ctl:ruleRemoveById=920180"

#Fix grafana metrics loading, modsec block some PromQL queries without this

SecRule REQUEST_URI "@beginsWith /admin/grafana/api/ds/query" \
	"id:10002, \
	phase:1, \
	nolog, \
	pass, \
	ctl:ruleRemoveById=942100-942999,ctl:ruleRemoveById=932100-932999"

#An other fix for grafana, modsec flags theses as SQL injection

SecRule REQUEST_URI "@beginsWith /admin/grafana/api/datasources/uid/" \
    "id:10003, \
	phase:1, \
	nolog, \
	pass, \
	ctl:ruleRemoveById=942290"